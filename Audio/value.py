# RNN =  {'classical.00000': {'offset_transformer': 0.01610638297872299, 'f_measure_beat_transformer': 1.0, 'offset_down_transformer': 1.2768333333333335, 'f_measure_downbeat_transformer': 0.0}, 'classical.00001': {'offset_transformer': 0.038140350877192836, 'f_measure_beat_transformer': 0.8085106382978723, 'offset_down_transformer': 8.474375, 'f_measure_downbeat_transformer': 0.18181818181818182}, 'classical.00002': {'offset_transformer': 0.02142424242424254, 'f_measure_beat_transformer': 1.0, 'offset_down_transformer': 3.37916, 'f_measure_downbeat_transformer': 0.28571428571428575}, 'classical.00003': {'offset_transformer': 0.04121874999999975, 'f_measure_beat_transformer': 0.8888888888888888, 'offset_down_transformer': 0.9432500000000004, 'f_measure_downbeat_transformer': 0.0}, 'classical.00004': {'offset_transformer': 0.02766666666666671, 'f_measure_beat_transformer': 0.9852941176470589, 'offset_down_transformer': 1.4579, 'f_measure_downbeat_transformer': 1.0}, 'classical.00005': {'offset_transformer': 0.032985714285714146, 'f_measure_beat_transformer': 0.8793103448275863, 'offset_down_transformer': 0.037478260869565266, 'f_measure_downbeat_transformer': 0.8421052631578947}, 'classical.00006': {'offset_transformer': 0.05864583333333321, 'f_measure_beat_transformer': 0.7250000000000001, 'offset_down_transformer': 1.3031666666666666, 'f_measure_downbeat_transformer': 0.0}, 'classical.00007': {'offset_transformer': 5.297771428571428, 'f_measure_beat_transformer': 0.37837837837837834, 'offset_down_transformer': 7.9435625000000005, 'f_measure_downbeat_transformer': 0.33333333333333326}, 'classical.00008': {'offset_transformer': 0.02653731343283565, 'f_measure_beat_transformer': 0.9911504424778761, 'offset_down_transformer': 7.973125, 'f_measure_downbeat_transformer': 0.6666666666666666}, 'classical.00009': {'offset_transformer': 0.48771428571428543, 'f_measure_beat_transformer': 0.24999999999999994, 'offset_down_transformer': 3.897, 'f_measure_downbeat_transformer': 0.5454545454545454}, 'country.00000': {'offset_transformer': 0.06526190476190488, 'f_measure_beat_transformer': 0.9577464788732395, 'offset_down_transformer': 0.07454545454545468, 'f_measure_downbeat_transformer': 1.0}, 'country.00001': {'offset_transformer': 0.4715625, 'f_measure_beat_transformer': 1.0, 'offset_down_transformer': 0.017000000000000237, 'f_measure_downbeat_transformer': 1.0}, 'country.00002': {'offset_transformer': 0.011084337349397438, 'f_measure_beat_transformer': 1.0, 'offset_down_transformer': 0.01000000000000013, 'f_measure_downbeat_transformer': 1.0}, 'country.00003': {'offset_transformer': 0.01130769230769226, 'f_measure_beat_transformer': 0.9850746268656716, 'offset_down_transformer': 0.011699999999999844, 'f_measure_downbeat_transformer': 1.0}, 'country.00004': {'offset_transformer': 0.009610169491525326, 'f_measure_beat_transformer': 1.0, 'offset_down_transformer': 0.011133333333333129, 'f_measure_downbeat_transformer': 1.0}, 'country.00005': {'offset_transformer': 0.00510606060606037, 'f_measure_beat_transformer': 1.0, 'offset_down_transformer': 0.0055624999999995955, 'f_measure_downbeat_transformer': 1.0}, 'country.00006': {'offset_transformer': 0.008596491228070064, 'f_measure_beat_transformer': 1.0, 'offset_down_transformer': 0.013285714285714392, 'f_measure_downbeat_transformer': 1.0}, 'country.00007': {'offset_transformer': 7.420923076923076, 'f_measure_beat_transformer': 0.634920634920635, 'offset_down_transformer': 7.124285714285714, 'f_measure_downbeat_transformer': 0.5882352941176471}, 'country.00008': {'offset_transformer': 0.00845454545454523, 'f_measure_beat_transformer': 1.0, 'offset_down_transformer': 8.157625, 'f_measure_downbeat_transformer': 0.6666666666666666}, 'country.00009': {'offset_transformer': 0.00630612244897943, 'f_measure_beat_transformer': 1.0, 'offset_down_transformer': 0.007749999999999461, 'f_measure_downbeat_transformer': 1.0}, 'disco.00000': {'offset_transformer': 0.015137931034482884, 'f_measure_beat_transformer': 1.0, 'offset_down_transformer': 0.026666666666666696, 'f_measure_downbeat_transformer': 1.0}, 'disco.00001': {'offset_transformer': 7.43228813559322, 'f_measure_beat_transformer': 0.6666666666666666, 'offset_down_transformer': 7.176933333333333, 'f_measure_downbeat_transformer': 0.6666666666666666}, 'disco.00002': {'offset_transformer': 7.340280701754387, 'f_measure_beat_transformer': 0.6713286713286714, 'offset_down_transformer': 7.342066666666667, 'f_measure_downbeat_transformer': 0.6666666666666666}, 'disco.00003': {'offset_transformer': 0.00764062499999996, 'f_measure_beat_transformer': 1.0, 'offset_down_transformer': 0.011062499999999725, 'f_measure_downbeat_transformer': 1.0}, 'disco.00004': {'offset_transformer': 0.011032786885245753, 'f_measure_beat_transformer': 1.0, 'offset_down_transformer': 0.01759999999999991, 'f_measure_downbeat_transformer': 1.0}, 'disco.00005': {'offset_transformer': 0.01200000000000022, 'f_measure_beat_transformer': 0.9777777777777777, 'offset_down_transformer': 0.020230769230769736, 'f_measure_downbeat_transformer': 1.0}, 'disco.00006': {'offset_transformer': 0.007693548387096785, 'f_measure_beat_transformer': 1.0, 'offset_down_transformer': 0.009187499999999509, 'f_measure_downbeat_transformer': 1.0}, 'disco.00007': {'offset_transformer': 0.006843749999999685, 'f_measure_beat_transformer': 1.0, 'offset_down_transformer': 0.012250000000000365, 'f_measure_downbeat_transformer': 1.0}, 'disco.00008': {'offset_transformer': 0.010131147540983553, 'f_measure_beat_transformer': 1.0, 'offset_down_transformer': 0.011866666666666196, 'f_measure_downbeat_transformer': 1.0}, 'disco.00009': {'offset_transformer': 0.012015384615384758, 'f_measure_beat_transformer': 1.0, 'offset_down_transformer': 0.016687499999999578, 'f_measure_downbeat_transformer': 1.0}, 'hiphop.00000': {'offset_transformer': 0.01726666666666669, 'f_measure_beat_transformer': 1.0, 'offset_down_transformer': 0.02079999999999959, 'f_measure_downbeat_transformer': 1.0}, 'hiphop.00001': {'offset_transformer': 0.012511111111111204, 'f_measure_beat_transformer': 0.9870129870129869, 'offset_down_transformer': 7.923181818181818, 'f_measure_downbeat_transformer': 0.6896551724137931}, 'hiphop.00002': {'offset_transformer': 0.01975999999999975, 'f_measure_beat_transformer': 1.0, 'offset_down_transformer': 0.03558333333333319, 'f_measure_downbeat_transformer': 1.0}, 'hiphop.00003': {'offset_transformer': 0.020369565217391302, 'f_measure_beat_transformer': 0.9873417721518987, 'offset_down_transformer': 1.3137272727272729, 'f_measure_downbeat_transformer': 0.0}, 'hiphop.00004': {'offset_transformer': 0.015624999999999889, 'f_measure_beat_transformer': 1.0, 'offset_down_transformer': 1.2295, 'f_measure_downbeat_transformer': 0.0}, 'hiphop.00005': {'offset_transformer': 0.021399999999999857, 'f_measure_beat_transformer': 0.9915966386554621, 'offset_down_transformer': 0.032944444444444415, 'f_measure_downbeat_transformer': 1.0}, 'hiphop.00006': {'offset_transformer': 0.015571428571428621, 'f_measure_beat_transformer': 0.9879518072289156, 'offset_down_transformer': 1.2173333333333334, 'f_measure_downbeat_transformer': 0.0}, 'hiphop.00007': {'offset_transformer': 0.02178333333333314, 'f_measure_beat_transformer': 0.94, 'offset_down_transformer': 0.027933333333333234, 'f_measure_downbeat_transformer': 0.9230769230769231}, 'hiphop.00008': {'offset_transformer': 7.480837209302325, 'f_measure_beat_transformer': 0.660377358490566, 'offset_down_transformer': 0.02199999999999982, 'f_measure_downbeat_transformer': 0.9411764705882353}, 'hiphop.00009': {'offset_transformer': 0.017788461538461205, 'f_measure_beat_transformer': 0.9655172413793104, 'offset_down_transformer': 0.030615384615384458, 'f_measure_downbeat_transformer': 0.9523809523809523}, 'jazz.00000': {'offset_transformer': 0.12074193548387087, 'f_measure_beat_transformer': 0.4423076923076923, 'offset_down_transformer': 0.13540000000000046, 'f_measure_downbeat_transformer': 0.3076923076923077}, 'jazz.00001': {'offset_transformer': 0.06552941176470573, 'f_measure_beat_transformer': 0.5964912280701754, 'offset_down_transformer': 3.503, 'f_measure_downbeat_transformer': 0.11764705882352941}, 'jazz.00002': {'offset_transformer': 0.21430612244897962, 'f_measure_beat_transformer': 0.674698795180723, 'offset_down_transformer': 0.21016666666666664, 'f_measure_downbeat_transformer': 0.5}, 'jazz.00004': {'offset_transformer': 0.03280645161290306, 'f_measure_beat_transformer': 0.8846153846153846, 'offset_down_transformer': 0.02649999999999948, 'f_measure_downbeat_transformer': 1.0}, 'jazz.00005': {'offset_transformer': 0.5411666666666668, 'f_measure_beat_transformer': 0.20224719101123598, 'offset_down_transformer': 3.765214285714285, 'f_measure_downbeat_transformer': 0.0}, 'jazz.00006': {'offset_transformer': 0.01423880597014914, 'f_measure_beat_transformer': 1.0, 'offset_down_transformer': 0.8894705882352938, 'f_measure_downbeat_transformer': 0.0}, 'jazz.00007': {'offset_transformer': 0.028700000000000163, 'f_measure_beat_transformer': 0.9803921568627451, 'offset_down_transformer': 1.9649999999999999, 'f_measure_downbeat_transformer': 0.0}, 'jazz.00008': {'offset_transformer': 0.015127272727272448, 'f_measure_beat_transformer': 1.0, 'offset_down_transformer': 1.1039285714285711, 'f_measure_downbeat_transformer': 0.0}, 'jazz.00011': {'offset_transformer': 0.01880198019801964, 'f_measure_beat_transformer': 1.0, 'offset_down_transformer': 7.723833333333334, 'f_measure_downbeat_transformer': 0.6451612903225806}, 'jazz.00012': {'offset_transformer': 0.017333333333332993, 'f_measure_beat_transformer': 1.0, 'offset_down_transformer': 0.018428571428571048, 'f_measure_downbeat_transformer': 1.0}, 'rock.00000': {'offset_transformer': 0.0375245901639343, 'f_measure_beat_transformer': 0.8039215686274509, 'offset_down_transformer': 0.04033333333333323, 'f_measure_downbeat_transformer': 0.7692307692307693}, 'rock.00001': {'offset_transformer': 0.02054054054054053, 'f_measure_beat_transformer': 1.0, 'offset_down_transformer': 0.02866666666666642, 'f_measure_downbeat_transformer': 1.0}, 'rock.00002': {'offset_transformer': 0.015226415094339571, 'f_measure_beat_transformer': 1.0, 'offset_down_transformer': 0.024769230769230603, 'f_measure_downbeat_transformer': 1.0}, 'rock.00003': {'offset_transformer': 0.018541666666666748, 'f_measure_beat_transformer': 1.0, 'offset_down_transformer': 1.24275, 'f_measure_downbeat_transformer': 0.0}, 'rock.00004': {'offset_transformer': 0.02179487179487195, 'f_measure_beat_transformer': 1.0, 'offset_down_transformer': 0.03170000000000006, 'f_measure_downbeat_transformer': 1.0}, 'rock.00005': {'offset_transformer': 0.35010204081632684, 'f_measure_beat_transformer': 0.1951219512195122, 'offset_down_transformer': 0.26033333333333303, 'f_measure_downbeat_transformer': 0.20000000000000004}, 'rock.00006': {'offset_transformer': 7.331689655172413, 'f_measure_beat_transformer': 0.6666666666666666, 'offset_down_transformer': 8.386999999999999, 'f_measure_downbeat_transformer': 0.6666666666666666}, 'rock.00007': {'offset_transformer': 0.02439999999999976, 'f_measure_beat_transformer': 1.0, 'offset_down_transformer': 0.02474999999999966, 'f_measure_downbeat_transformer': 1.0}, 'rock.00008': {'offset_transformer': 0.034022222222222155, 'f_measure_beat_transformer': 0.7567567567567567, 'offset_down_transformer': 0.041583333333332834, 'f_measure_downbeat_transformer': 0.8000000000000002}, 'rock.00009': {'offset_transformer': 0.01952631578947388, 'f_measure_beat_transformer': 1.0, 'offset_down_transformer': 1.5735555555555554, 'f_measure_downbeat_transformer': 0.0}, 'blues.00000': {'offset_transformer': 0.01512698412698386, 'f_measure_beat_transformer': 0.9811320754716981, 'offset_down_transformer': 0.020874999999999727, 'f_measure_downbeat_transformer': 0.9285714285714286}, 'blues.00001': {'offset_transformer': 0.01691176470588243, 'f_measure_beat_transformer': 1.0, 'offset_down_transformer': 10.99625, 'f_measure_downbeat_transformer': 0.4}, 'blues.00002': {'offset_transformer': 0.01164102564102571, 'f_measure_beat_transformer': 0.9923664122137404, 'offset_down_transformer': 0.010894736842105384, 'f_measure_downbeat_transformer': 1.0}, 'blues.00003': {'offset_transformer': 0.014838709677419414, 'f_measure_beat_transformer': 1.0, 'offset_down_transformer': 10.08775, 'f_measure_downbeat_transformer': 0.375}, 'blues.00004': {'offset_transformer': 0.024462686567164126, 'f_measure_beat_transformer': 0.9821428571428571, 'offset_down_transformer': 0.8786470588235297, 'f_measure_downbeat_transformer': 0.0}, 'blues.00005': {'offset_transformer': 0.024600000000000087, 'f_measure_beat_transformer': 0.896551724137931, 'offset_down_transformer': 2.6470000000000002, 'f_measure_downbeat_transformer': 0.0}, 'blues.00006': {'offset_transformer': 0.03421621621621618, 'f_measure_beat_transformer': 0.9032258064516129, 'offset_down_transformer': 0.8601111111111114, 'f_measure_downbeat_transformer': 0.0}, 'blues.00007': {'offset_transformer': 0.015404255319149011, 'f_measure_beat_transformer': 0.9743589743589743, 'offset_down_transformer': 1.9300909090909089, 'f_measure_downbeat_transformer': 0.0}, 'blues.00008': {'offset_transformer': 0.020952380952381208, 'f_measure_beat_transformer': 0.9787234042553192, 'offset_down_transformer': 0.6886190476190474, 'f_measure_downbeat_transformer': 0.0}, 'blues.00009': {'offset_transformer': 0.030649999999999976, 'f_measure_beat_transformer': 0.8955223880597014, 'offset_down_transformer': 2.1665, 'f_measure_downbeat_transformer': 0.0}, 'reggae.00000': {'offset_transformer': 0.01136065573770493, 'f_measure_beat_transformer': 1.0, 'offset_down_transformer': 0.9719333333333331, 'f_measure_downbeat_transformer': 0.0}, 'reggae.00001': {'offset_transformer': 0.012897435897435744, 'f_measure_beat_transformer': 1.0, 'offset_down_transformer': 0.785444444444444, 'f_measure_downbeat_transformer': 0.0}, 'reggae.00002': {'offset_transformer': 7.536607843137254, 'f_measure_beat_transformer': 0.6615384615384615, 'offset_down_transformer': 6.951, 'f_measure_downbeat_transformer': 0.6666666666666666}, 'reggae.00003': {'offset_transformer': 0.4162465753424656, 'f_measure_beat_transformer': 0.991869918699187, 'offset_down_transformer': 0.8300000000000002, 'f_measure_downbeat_transformer': 0.0}, 'reggae.00004': {'offset_transformer': 0.012142857142856985, 'f_measure_beat_transformer': 0.9807692307692307, 'offset_down_transformer': 1.4411999999999996, 'f_measure_downbeat_transformer': 0.0}, 'reggae.00005': {'offset_transformer': 0.009166666666666668, 'f_measure_beat_transformer': 1.0, 'offset_down_transformer': 0.779157894736842, 'f_measure_downbeat_transformer': 0.0}, 'reggae.00006': {'offset_transformer': 0.007026666666666479, 'f_measure_beat_transformer': 1.0, 'offset_down_transformer': 0.0086315789473682, 'f_measure_downbeat_transformer': 1.0}, 'reggae.00007': {'offset_transformer': 0.007945945945945937, 'f_measure_beat_transformer': 0.9841269841269841, 'offset_down_transformer': 0.789157894736842, 'f_measure_downbeat_transformer': 0.0}, 'reggae.00008': {'offset_transformer': 7.474020408163266, 'f_measure_beat_transformer': 0.6557377049180327, 'offset_down_transformer': 7.466916666666667, 'f_measure_downbeat_transformer': 0.0}, 'reggae.00009': {'offset_transformer': 0.009632911392404991, 'f_measure_beat_transformer': 1.0, 'offset_down_transformer': 0.3816999999999998, 'f_measure_downbeat_transformer': 0.0}, 'pop.00000': {'offset_transformer': 7.6789696969696974, 'f_measure_beat_transformer': 0.6666666666666666, 'offset_down_transformer': 7.6777500000000005, 'f_measure_downbeat_transformer': 0.0}, 'pop.00001': {'offset_transformer': 0.013576923076923129, 'f_measure_beat_transformer': 0.9887640449438202, 'offset_down_transformer': 0.016846153846153417, 'f_measure_downbeat_transformer': 0.9565217391304348}, 'pop.00002': {'offset_transformer': 0.011047619047619051, 'f_measure_beat_transformer': 1.0, 'offset_down_transformer': 0.018312500000000093, 'f_measure_downbeat_transformer': 1.0}, 'pop.00003': {'offset_transformer': 0.014173913043478106, 'f_measure_beat_transformer': 0.9870129870129869, 'offset_down_transformer': 0.016909090909090683, 'f_measure_downbeat_transformer': 0.9473684210526316}, 'pop.00004': {'offset_transformer': 7.2941, 'f_measure_beat_transformer': 0.66, 'offset_down_transformer': 6.736099999999999, 'f_measure_downbeat_transformer': 0.6666666666666666}, 'pop.00005': {'offset_transformer': 0.6580243902439024, 'f_measure_beat_transformer': 1.0, 'offset_down_transformer': 0.011545454545454768, 'f_measure_downbeat_transformer': 1.0}, 'pop.00006': {'offset_transformer': 0.015065217391304354, 'f_measure_beat_transformer': 0.9870129870129869, 'offset_down_transformer': 0.027636363636364066, 'f_measure_downbeat_transformer': 0.9473684210526316}, 'pop.00007': {'offset_transformer': 0.01046874999999977, 'f_measure_beat_transformer': 1.0, 'offset_down_transformer': 6.620875, 'f_measure_downbeat_transformer': 0.631578947368421}, 'pop.00008': {'offset_transformer': 0.008619047619047606, 'f_measure_beat_transformer': 1.0, 'offset_down_transformer': 0.014100000000000178, 'f_measure_downbeat_transformer': 1.0}, 'pop.00009': {'offset_transformer': 0.015176470588235463, 'f_measure_beat_transformer': 0.9885057471264368, 'offset_down_transformer': 0.018083333333333302, 'f_measure_downbeat_transformer': 0.9523809523809523}, 'metal.00000': {'offset_transformer': 0.016085106382978526, 'f_measure_beat_transformer': 1.0, 'offset_down_transformer': 0.025166666666666643, 'f_measure_downbeat_transformer': 1.0}, 'metal.00001': {'offset_transformer': 0.00971794871794865, 'f_measure_beat_transformer': 1.0, 'offset_down_transformer': 0.007699999999999946, 'f_measure_downbeat_transformer': 1.0}, 'metal.00002': {'offset_transformer': 0.013410714285714113, 'f_measure_beat_transformer': 1.0, 'offset_down_transformer': 0.022285714285714624, 'f_measure_downbeat_transformer': 1.0}, 'metal.00003': {'offset_transformer': 7.47994, 'f_measure_beat_transformer': 0.6611570247933884, 'offset_down_transformer': 0.018833333333333407, 'f_measure_downbeat_transformer': 0.975609756097561}, 'metal.00004': {'offset_transformer': 0.14746376811594195, 'f_measure_beat_transformer': 0.0, 'offset_down_transformer': 0.13047058823529384, 'f_measure_downbeat_transformer': 0.20689655172413796}, 'metal.00005': {'offset_transformer': 0.011896103896103927, 'f_measure_beat_transformer': 0.9922480620155039, 'offset_down_transformer': 0.016549999999999586, 'f_measure_downbeat_transformer': 1.0}, 'metal.00006': {'offset_transformer': 0.026350000000000158, 'f_measure_beat_transformer': 0.96, 'offset_down_transformer': 0.02240000000000038, 'f_measure_downbeat_transformer': 0.9166666666666666}, 'metal.00007': {'offset_transformer': 0.02786842105263167, 'f_measure_beat_transformer': 0.9682539682539683, 'offset_down_transformer': 0.8006842105263162, 'f_measure_downbeat_transformer': 0.0}, 'metal.00008': {'offset_transformer': 0.010491525423728823, 'f_measure_beat_transformer': 1.0, 'offset_down_transformer': 0.009933333333333112, 'f_measure_downbeat_transformer': 1.0}, 'metal.00009': {'offset_transformer': 4.9496315789473675, 'f_measure_beat_transformer': 0.40336134453781514, 'offset_down_transformer': 5.122357142857141, 'f_measure_downbeat_transformer': 0.0}}
# TCN =  {'classical.00000': {'offset_transformer': 0.014234042553191136, 'f_measure_beat_transformer': 1.0, 'offset_down_transformer': 1.276, 'f_measure_downbeat_transformer': 0.0}, 'classical.00001': {'offset_transformer': 7.6636428571428565, 'f_measure_beat_transformer': 0.5428571428571428, 'offset_down_transformer': 7.1538571428571425, 'f_measure_downbeat_transformer': 0.09523809523809523}, 'classical.00002': {'offset_transformer': 7.410159999999999, 'f_measure_beat_transformer': 0.6719999999999999, 'offset_down_transformer': 5.742375, 'f_measure_downbeat_transformer': 0.4}, 'classical.00003': {'offset_transformer': 0.0334687499999997, 'f_measure_beat_transformer': 0.9259259259259259, 'offset_down_transformer': 0.9132500000000003, 'f_measure_downbeat_transformer': 0.0}, 'classical.00004': {'offset_transformer': 0.027098765432098746, 'f_measure_beat_transformer': 1.0, 'offset_down_transformer': 8.963222222222221, 'f_measure_downbeat_transformer': 0.4}, 'classical.00005': {'offset_transformer': 0.3151857142857141, 'f_measure_beat_transformer': 0.8034188034188032, 'offset_down_transformer': 12.566875, 'f_measure_downbeat_transformer': 0.15384615384615385}, 'classical.00006': {'offset_transformer': 0.05664583333333337, 'f_measure_beat_transformer': 0.75, 'offset_down_transformer': 1.291363636363636, 'f_measure_downbeat_transformer': 0.0}, 'classical.00007': {'offset_transformer': 5.296628571428571, 'f_measure_beat_transformer': 0.35135135135135137, 'offset_down_transformer': 9.062, 'f_measure_downbeat_transformer': 0.12500000000000003}, 'classical.00008': {'offset_transformer': 6.821571428571429, 'f_measure_beat_transformer': 0.6352941176470589, 'offset_down_transformer': 0.16558823529411745, 'f_measure_downbeat_transformer': 0.7586206896551724}, 'classical.00009': {'offset_transformer': 0.4717142857142856, 'f_measure_beat_transformer': 0.16666666666666666, 'offset_down_transformer': 3.9419999999999997, 'f_measure_downbeat_transformer': 0.5454545454545454}, 'country.00000': {'offset_transformer': 0.06550000000000009, 'f_measure_beat_transformer': 0.9577464788732395, 'offset_down_transformer': 0.07545454545454557, 'f_measure_downbeat_transformer': 1.0}, 'country.00001': {'offset_transformer': 0.015031250000000083, 'f_measure_beat_transformer': 1.0, 'offset_down_transformer': 0.017000000000000237, 'f_measure_downbeat_transformer': 1.0}, 'country.00002': {'offset_transformer': 7.68048780487805, 'f_measure_beat_transformer': 0.6601941747572816, 'offset_down_transformer': 6.586099999999999, 'f_measure_downbeat_transformer': 0.6399999999999999}, 'country.00003': {'offset_transformer': 0.014538461538461403, 'f_measure_beat_transformer': 0.9850746268656716, 'offset_down_transformer': 0.011699999999999844, 'f_measure_downbeat_transformer': 1.0}, 'country.00004': {'offset_transformer': 0.01442372881355923, 'f_measure_beat_transformer': 1.0, 'offset_down_transformer': 0.012999999999999871, 'f_measure_downbeat_transformer': 1.0}, 'country.00005': {'offset_transformer': 0.00898484848484832, 'f_measure_beat_transformer': 1.0, 'offset_down_transformer': 0.004562499999999928, 'f_measure_downbeat_transformer': 1.0}, 'country.00006': {'offset_transformer': 0.014070175438596563, 'f_measure_beat_transformer': 1.0, 'offset_down_transformer': 0.01285714285714282, 'f_measure_downbeat_transformer': 1.0}, 'country.00007': {'offset_transformer': 7.432076923076924, 'f_measure_beat_transformer': 0.634920634920635, 'offset_down_transformer': 7.127142857142856, 'f_measure_downbeat_transformer': 0.5882352941176471}, 'country.00008': {'offset_transformer': 0.013848484848484562, 'f_measure_beat_transformer': 1.0, 'offset_down_transformer': 8.157625, 'f_measure_downbeat_transformer': 0.6666666666666666}, 'country.00009': {'offset_transformer': 0.009489795918367301, 'f_measure_beat_transformer': 1.0, 'offset_down_transformer': 0.007916666666666275, 'f_measure_downbeat_transformer': 1.0}, 'disco.00000': {'offset_transformer': 0.019137931034482688, 'f_measure_beat_transformer': 1.0, 'offset_down_transformer': 0.026666666666666696, 'f_measure_downbeat_transformer': 1.0}, 'disco.00001': {'offset_transformer': 7.425338983050846, 'f_measure_beat_transformer': 0.6666666666666666, 'offset_down_transformer': 7.1716, 'f_measure_downbeat_transformer': 0.6666666666666666}, 'disco.00002': {'offset_transformer': 7.3362456140350885, 'f_measure_beat_transformer': 0.6713286713286714, 'offset_down_transformer': 7.340733333333333, 'f_measure_downbeat_transformer': 0.6666666666666666}, 'disco.00003': {'offset_transformer': 0.011046875000000012, 'f_measure_beat_transformer': 1.0, 'offset_down_transformer': 0.01193750000000024, 'f_measure_downbeat_transformer': 1.0}, 'disco.00004': {'offset_transformer': 0.015262295081967182, 'f_measure_beat_transformer': 1.0, 'offset_down_transformer': 0.018933333333333215, 'f_measure_downbeat_transformer': 1.0}, 'disco.00005': {'offset_transformer': 0.014679245283019234, 'f_measure_beat_transformer': 0.9777777777777777, 'offset_down_transformer': 0.020230769230769736, 'f_measure_downbeat_transformer': 1.0}, 'disco.00006': {'offset_transformer': 0.010306451612903422, 'f_measure_beat_transformer': 1.0, 'offset_down_transformer': 0.00993749999999955, 'f_measure_downbeat_transformer': 1.0}, 'disco.00007': {'offset_transformer': 0.010624999999999907, 'f_measure_beat_transformer': 1.0, 'offset_down_transformer': 0.012250000000000365, 'f_measure_downbeat_transformer': 1.0}, 'disco.00008': {'offset_transformer': 0.012655737704917978, 'f_measure_beat_transformer': 1.0, 'offset_down_transformer': 0.011866666666666196, 'f_measure_downbeat_transformer': 1.0}, 'disco.00009': {'offset_transformer': 0.016292307692307734, 'f_measure_beat_transformer': 1.0, 'offset_down_transformer': 0.016687499999999578, 'f_measure_downbeat_transformer': 1.0}, 'hiphop.00000': {'offset_transformer': 0.022899999999999993, 'f_measure_beat_transformer': 1.0, 'offset_down_transformer': 0.025466666666666155, 'f_measure_downbeat_transformer': 1.0}, 'hiphop.00001': {'offset_transformer': 0.013533333333333526, 'f_measure_beat_transformer': 0.9870129870129869, 'offset_down_transformer': 1.3377272727272733, 'f_measure_downbeat_transformer': 0.0}, 'hiphop.00002': {'offset_transformer': 0.023719999999999616, 'f_measure_beat_transformer': 1.0, 'offset_down_transformer': 0.03558333333333319, 'f_measure_downbeat_transformer': 1.0}, 'hiphop.00003': {'offset_transformer': 0.021021739130434914, 'f_measure_beat_transformer': 0.9873417721518987, 'offset_down_transformer': 1.3137272727272729, 'f_measure_downbeat_transformer': 0.0}, 'hiphop.00004': {'offset_transformer': 0.01979166666666653, 'f_measure_beat_transformer': 1.0, 'offset_down_transformer': 0.028833333333333586, 'f_measure_downbeat_transformer': 1.0}, 'hiphop.00005': {'offset_transformer': 0.03108571428571437, 'f_measure_beat_transformer': 0.9915966386554621, 'offset_down_transformer': 0.032944444444444415, 'f_measure_downbeat_transformer': 1.0}, 'hiphop.00006': {'offset_transformer': 0.01842857142857147, 'f_measure_beat_transformer': 0.9879518072289156, 'offset_down_transformer': 1.2198333333333335, 'f_measure_downbeat_transformer': 0.0}, 'hiphop.00007': {'offset_transformer': 0.024583333333333127, 'f_measure_beat_transformer': 0.94, 'offset_down_transformer': 0.027933333333333234, 'f_measure_downbeat_transformer': 0.9230769230769231}, 'hiphop.00008': {'offset_transformer': 0.02460465116279052, 'f_measure_beat_transformer': 0.9722222222222222, 'offset_down_transformer': 0.16918181818181754, 'f_measure_downbeat_transformer': 0.6666666666666666}, 'hiphop.00009': {'offset_transformer': 0.024749999999999793, 'f_measure_beat_transformer': 0.9655172413793104, 'offset_down_transformer': 0.03138461538461521, 'f_measure_downbeat_transformer': 0.9523809523809523}, 'jazz.00000': {'offset_transformer': 0.11816129032258044, 'f_measure_beat_transformer': 0.4423076923076923, 'offset_down_transformer': 0.7607333333333336, 'f_measure_downbeat_transformer': 0.0}, 'jazz.00001': {'offset_transformer': 0.6982571428571429, 'f_measure_beat_transformer': 0.3934426229508197, 'offset_down_transformer': 3.896333333333333, 'f_measure_downbeat_transformer': 0.10526315789473685}, 'jazz.00002': {'offset_transformer': 0.21659183673469387, 'f_measure_beat_transformer': 0.674698795180723, 'offset_down_transformer': 0.2168333333333333, 'f_measure_downbeat_transformer': 0.4000000000000001}, 'jazz.00004': {'offset_transformer': 0.03777419354838678, 'f_measure_beat_transformer': 0.8846153846153846, 'offset_down_transformer': 0.02549999999999968, 'f_measure_downbeat_transformer': 1.0}, 'jazz.00005': {'offset_transformer': 0.8166111111111112, 'f_measure_beat_transformer': 0.711111111111111, 'offset_down_transformer': 3.9273571428571423, 'f_measure_downbeat_transformer': 0.23076923076923075}, 'jazz.00006': {'offset_transformer': 0.02277611940298515, 'f_measure_beat_transformer': 1.0, 'offset_down_transformer': 0.8800588235294114, 'f_measure_downbeat_transformer': 0.0}, 'jazz.00007': {'offset_transformer': 0.026099999999999998, 'f_measure_beat_transformer': 0.9803921568627451, 'offset_down_transformer': 0.031000000000000028, 'f_measure_downbeat_transformer': 1.0}, 'jazz.00008': {'offset_transformer': 0.019745454545454316, 'f_measure_beat_transformer': 0.989010989010989, 'offset_down_transformer': 1.1124999999999996, 'f_measure_downbeat_transformer': 0.0}, 'jazz.00011': {'offset_transformer': 0.03006930693069298, 'f_measure_beat_transformer': 1.0, 'offset_down_transformer': 7.698833333333333, 'f_measure_downbeat_transformer': 0.5806451612903225}, 'jazz.00012': {'offset_transformer': 0.021964912280701597, 'f_measure_beat_transformer': 1.0, 'offset_down_transformer': 0.02571428571428556, 'f_measure_downbeat_transformer': 0.9166666666666666}, 'rock.00000': {'offset_transformer': 7.420612903225808, 'f_measure_beat_transformer': 0.5714285714285715, 'offset_down_transformer': 0.17633333333333343, 'f_measure_downbeat_transformer': 0.07692307692307693}, 'rock.00001': {'offset_transformer': 0.02837837837837847, 'f_measure_beat_transformer': 1.0, 'offset_down_transformer': 0.03422222222222206, 'f_measure_downbeat_transformer': 1.0}, 'rock.00002': {'offset_transformer': 0.019377358490566012, 'f_measure_beat_transformer': 1.0, 'offset_down_transformer': 0.024769230769230603, 'f_measure_downbeat_transformer': 1.0}, 'rock.00003': {'offset_transformer': 0.023166666666666613, 'f_measure_beat_transformer': 1.0, 'offset_down_transformer': 1.2402499999999999, 'f_measure_downbeat_transformer': 0.0}, 'rock.00004': {'offset_transformer': 0.029743589743589906, 'f_measure_beat_transformer': 1.0, 'offset_down_transformer': 0.032700000000000215, 'f_measure_downbeat_transformer': 1.0}, 'rock.00005': {'offset_transformer': 0.33908163265306124, 'f_measure_beat_transformer': 0.1951219512195122, 'offset_down_transformer': 0.2611666666666665, 'f_measure_downbeat_transformer': 0.20000000000000004}, 'rock.00006': {'offset_transformer': 0.022448275862068906, 'f_measure_beat_transformer': 0.9583333333333334, 'offset_down_transformer': 8.386999999999999, 'f_measure_downbeat_transformer': 0.6666666666666666}, 'rock.00007': {'offset_transformer': 0.02586666666666675, 'f_measure_beat_transformer': 1.0, 'offset_down_transformer': 0.02474999999999966, 'f_measure_downbeat_transformer': 1.0}, 'rock.00008': {'offset_transformer': 0.03335555555555544, 'f_measure_beat_transformer': 0.8378378378378378, 'offset_down_transformer': 0.044916666666666466, 'f_measure_downbeat_transformer': 0.7}, 'rock.00009': {'offset_transformer': 0.02173684210526332, 'f_measure_beat_transformer': 1.0, 'offset_down_transformer': 1.5713333333333332, 'f_measure_downbeat_transformer': 0.0}, 'blues.00000': {'offset_transformer': 0.013317460317460204, 'f_measure_beat_transformer': 0.9811320754716981, 'offset_down_transformer': 0.009533333333333201, 'f_measure_downbeat_transformer': 0.962962962962963}, 'blues.00001': {'offset_transformer': 0.012794117647058874, 'f_measure_beat_transformer': 1.0, 'offset_down_transformer': 7.93625, 'f_measure_downbeat_transformer': 0.6666666666666666}, 'blues.00002': {'offset_transformer': 0.010743589743589965, 'f_measure_beat_transformer': 0.9923664122137404, 'offset_down_transformer': 0.009000000000000235, 'f_measure_downbeat_transformer': 1.0}, 'blues.00003': {'offset_transformer': 0.013161290322580762, 'f_measure_beat_transformer': 1.0, 'offset_down_transformer': 10.084000000000001, 'f_measure_downbeat_transformer': 0.375}, 'blues.00004': {'offset_transformer': 0.02541791044776118, 'f_measure_beat_transformer': 0.9821428571428571, 'offset_down_transformer': 0.030529411764705562, 'f_measure_downbeat_transformer': 0.9285714285714286}, 'blues.00005': {'offset_transformer': 0.022600000000000075, 'f_measure_beat_transformer': 0.896551724137931, 'offset_down_transformer': 1.7588888888888892, 'f_measure_downbeat_transformer': 0.0}, 'blues.00006': {'offset_transformer': 0.03454054054054037, 'f_measure_beat_transformer': 0.9032258064516129, 'offset_down_transformer': 4.973444444444445, 'f_measure_downbeat_transformer': 0.3157894736842105}, 'blues.00007': {'offset_transformer': 0.016510638297872127, 'f_measure_beat_transformer': 0.9743589743589743, 'offset_down_transformer': 1.9282727272727271, 'f_measure_downbeat_transformer': 0.0}, 'blues.00008': {'offset_transformer': 0.030642857142857173, 'f_measure_beat_transformer': 0.9787234042553192, 'offset_down_transformer': 0.6833809523809523, 'f_measure_downbeat_transformer': 0.0}, 'blues.00009': {'offset_transformer': 0.03259999999999983, 'f_measure_beat_transformer': 0.8059701492537314, 'offset_down_transformer': 1.4325, 'f_measure_downbeat_transformer': 0.0}, 'reggae.00000': {'offset_transformer': 0.013426229508196837, 'f_measure_beat_transformer': 1.0, 'offset_down_transformer': 0.9619333333333332, 'f_measure_downbeat_transformer': 0.0}, 'reggae.00001': {'offset_transformer': 0.015512820512820612, 'f_measure_beat_transformer': 1.0, 'offset_down_transformer': 1.555444444444444, 'f_measure_downbeat_transformer': 0.0}, 'reggae.00002': {'offset_transformer': 7.531509803921569, 'f_measure_beat_transformer': 0.6615384615384615, 'offset_down_transformer': 6.951, 'f_measure_downbeat_transformer': 0.6666666666666666}, 'reggae.00003': {'offset_transformer': 0.014876712328767033, 'f_measure_beat_transformer': 0.991869918699187, 'offset_down_transformer': 0.7866666666666666, 'f_measure_downbeat_transformer': 0.0}, 'reggae.00004': {'offset_transformer': 0.014428571428571258, 'f_measure_beat_transformer': 0.9807692307692307, 'offset_down_transformer': 0.46856249999999966, 'f_measure_downbeat_transformer': 0.0}, 'reggae.00005': {'offset_transformer': 7.674153846153847, 'f_measure_beat_transformer': 0.673469387755102, 'offset_down_transformer': 0.7807368421052632, 'f_measure_downbeat_transformer': 0.0}, 'reggae.00006': {'offset_transformer': 7.578621621621622, 'f_measure_beat_transformer': 0.6666666666666666, 'offset_down_transformer': 0.009684210526315651, 'f_measure_downbeat_transformer': 1.0}, 'reggae.00007': {'offset_transformer': 7.687105263157895, 'f_measure_beat_transformer': 0.6595744680851063, 'offset_down_transformer': 0.7859999999999998, 'f_measure_downbeat_transformer': 0.0}, 'reggae.00008': {'offset_transformer': 7.4672857142857145, 'f_measure_beat_transformer': 0.6557377049180327, 'offset_down_transformer': 7.463583333333332, 'f_measure_downbeat_transformer': 0.0}, 'reggae.00009': {'offset_transformer': 0.010746835443037932, 'f_measure_beat_transformer': 1.0, 'offset_down_transformer': 7.977199999999999, 'f_measure_downbeat_transformer': 0.0}, 'pop.00000': {'offset_transformer': 0.014424242424242393, 'f_measure_beat_transformer': 1.0, 'offset_down_transformer': 0.01900000000000024, 'f_measure_downbeat_transformer': 1.0}, 'pop.00001': {'offset_transformer': 0.017615384615384696, 'f_measure_beat_transformer': 0.9887640449438202, 'offset_down_transformer': 0.016846153846153417, 'f_measure_downbeat_transformer': 0.9565217391304348}, 'pop.00002': {'offset_transformer': 0.01638095238095227, 'f_measure_beat_transformer': 1.0, 'offset_down_transformer': 0.01893750000000008, 'f_measure_downbeat_transformer': 1.0}, 'pop.00003': {'offset_transformer': 0.017999999999999853, 'f_measure_beat_transformer': 0.9870129870129869, 'offset_down_transformer': 0.016909090909090683, 'f_measure_downbeat_transformer': 0.9473684210526316}, 'pop.00004': {'offset_transformer': 0.3566499999999996, 'f_measure_beat_transformer': 0.0, 'offset_down_transformer': 0.013099999999999806, 'f_measure_downbeat_transformer': 1.0}, 'pop.00005': {'offset_transformer': 0.0195476190476191, 'f_measure_beat_transformer': 1.0, 'offset_down_transformer': 0.011545454545454768, 'f_measure_downbeat_transformer': 1.0}, 'pop.00006': {'offset_transformer': 0.020586956521739367, 'f_measure_beat_transformer': 0.9870129870129869, 'offset_down_transformer': 0.027636363636364066, 'f_measure_downbeat_transformer': 0.9473684210526316}, 'pop.00007': {'offset_transformer': 0.010843749999999937, 'f_measure_beat_transformer': 1.0, 'offset_down_transformer': 6.620875, 'f_measure_downbeat_transformer': 0.631578947368421}, 'pop.00008': {'offset_transformer': 0.014714285714285643, 'f_measure_beat_transformer': 1.0, 'offset_down_transformer': 0.014100000000000178, 'f_measure_downbeat_transformer': 1.0}, 'pop.00009': {'offset_transformer': 0.022980392156862792, 'f_measure_beat_transformer': 0.9885057471264368, 'offset_down_transformer': 0.018083333333333302, 'f_measure_downbeat_transformer': 0.9523809523809523}, 'metal.00000': {'offset_transformer': 0.021319148936170176, 'f_measure_beat_transformer': 1.0, 'offset_down_transformer': 0.028833333333333665, 'f_measure_downbeat_transformer': 1.0}, 'metal.00001': {'offset_transformer': 7.679564102564102, 'f_measure_beat_transformer': 0.6597938144329897, 'offset_down_transformer': 1.1278947368421055, 'f_measure_downbeat_transformer': 0.0}, 'metal.00002': {'offset_transformer': 0.019839285714285827, 'f_measure_beat_transformer': 1.0, 'offset_down_transformer': 0.022285714285714624, 'f_measure_downbeat_transformer': 1.0}, 'metal.00003': {'offset_transformer': 7.781469387755101, 'f_measure_beat_transformer': 0.4297520661157025, 'offset_down_transformer': 4.8653529411764715, 'f_measure_downbeat_transformer': 0.3529411764705882}, 'metal.00004': {'offset_transformer': 0.13036231884057972, 'f_measure_beat_transformer': 0.0, 'offset_down_transformer': 3.975999999999999, 'f_measure_downbeat_transformer': 0.0}, 'metal.00005': {'offset_transformer': 7.765897435897437, 'f_measure_beat_transformer': 0.6597938144329897, 'offset_down_transformer': 0.0179499999999997, 'f_measure_downbeat_transformer': 1.0}, 'metal.00006': {'offset_transformer': 0.025283333333333585, 'f_measure_beat_transformer': 0.94, 'offset_down_transformer': 0.023866666666666946, 'f_measure_downbeat_transformer': 0.9166666666666666}, 'metal.00007': {'offset_transformer': 7.310604651162791, 'f_measure_beat_transformer': 0.38383838383838387, 'offset_down_transformer': 8.747000000000002, 'f_measure_downbeat_transformer': 0.0}, 'metal.00008': {'offset_transformer': 0.010966101694915291, 'f_measure_beat_transformer': 1.0, 'offset_down_transformer': 0.009933333333333112, 'f_measure_downbeat_transformer': 1.0}, 'metal.00009': {'offset_transformer': 7.380862068965516, 'f_measure_beat_transformer': 0.6666666666666666, 'offset_down_transformer': 6.199, 'f_measure_downbeat_transformer': 0.0}}

# # RNN =  {'pop.00000': {'offset_transformer': 7.6789696969696974, 'f_measure_beat_transformer': 0.6666666666666666, 'offset_down_transformer': 7.6777500000000005, 'f_measure_downbeat_transformer': 0.0}, 'pop.00001': {'offset_transformer': 0.013576923076923129, 'f_measure_beat_transformer': 0.9887640449438202, 'offset_down_transformer': 0.016846153846153417, 'f_measure_downbeat_transformer': 0.9565217391304348}, 'pop.00002': {'offset_transformer': 0.011047619047619051, 'f_measure_beat_transformer': 1.0, 'offset_down_transformer': 0.018312500000000093, 'f_measure_downbeat_transformer': 1.0}, 'pop.00003': {'offset_transformer': 0.014173913043478106, 'f_measure_beat_transformer': 0.9870129870129869, 'offset_down_transformer': 0.016909090909090683, 'f_measure_downbeat_transformer': 0.9473684210526316}, 'pop.00004': {'offset_transformer': 7.2941, 'f_measure_beat_transformer': 0.66, 'offset_down_transformer': 6.736099999999999, 'f_measure_downbeat_transformer': 0.6666666666666666}, 'pop.00005': {'offset_transformer': 0.6580243902439024, 'f_measure_beat_transformer': 1.0, 'offset_down_transformer': 0.011545454545454768, 'f_measure_downbeat_transformer': 1.0}, 'pop.00006': {'offset_transformer': 0.015065217391304354, 'f_measure_beat_transformer': 0.9870129870129869, 'offset_down_transformer': 0.027636363636364066, 'f_measure_downbeat_transformer': 0.9473684210526316}, 'pop.00007': {'offset_transformer': 0.01046874999999977, 'f_measure_beat_transformer': 1.0, 'offset_down_transformer': 6.620875, 'f_measure_downbeat_transformer': 0.631578947368421}, 'pop.00008': {'offset_transformer': 0.008619047619047606, 'f_measure_beat_transformer': 1.0, 'offset_down_transformer': 0.014100000000000178, 'f_measure_downbeat_transformer': 1.0}, 'pop.00009': {'offset_transformer': 0.015176470588235463, 'f_measure_beat_transformer': 0.9885057471264368, 'offset_down_transformer': 0.018083333333333302, 'f_measure_downbeat_transformer': 0.9523809523809523}}
# # TCN =  {'pop.00000': {'offset_transformer': 0.014424242424242393, 'f_measure_beat_transformer': 1.0, 'offset_down_transformer': 0.01900000000000024, 'f_measure_downbeat_transformer': 1.0}, 'pop.00001': {'offset_transformer': 0.017615384615384696, 'f_measure_beat_transformer': 0.9887640449438202, 'offset_down_transformer': 0.016846153846153417, 'f_measure_downbeat_transformer': 0.9565217391304348}, 'pop.00002': {'offset_transformer': 0.01638095238095227, 'f_measure_beat_transformer': 1.0, 'offset_down_transformer': 0.01893750000000008, 'f_measure_downbeat_transformer': 1.0}, 'pop.00003': {'offset_transformer': 0.017999999999999853, 'f_measure_beat_transformer': 0.9870129870129869, 'offset_down_transformer': 0.016909090909090683, 'f_measure_downbeat_transformer': 0.9473684210526316}, 'pop.00004': {'offset_transformer': 0.3566499999999996, 'f_measure_beat_transformer': 0.0, 'offset_down_transformer': 0.013099999999999806, 'f_measure_downbeat_transformer': 1.0}, 'pop.00005': {'offset_transformer': 0.0195476190476191, 'f_measure_beat_transformer': 1.0, 'offset_down_transformer': 0.011545454545454768, 'f_measure_downbeat_transformer': 1.0}, 'pop.00006': {'offset_transformer': 0.020586956521739367, 'f_measure_beat_transformer': 0.9870129870129869, 'offset_down_transformer': 0.027636363636364066, 'f_measure_downbeat_transformer': 0.9473684210526316}, 'pop.00007': {'offset_transformer': 0.010843749999999937, 'f_measure_beat_transformer': 1.0, 'offset_down_transformer': 6.620875, 'f_measure_downbeat_transformer': 0.631578947368421}, 'pop.00008': {'offset_transformer': 0.014714285714285643, 'f_measure_beat_transformer': 1.0, 'offset_down_transformer': 0.014100000000000178, 'f_measure_downbeat_transformer': 1.0}, 'pop.00009': {'offset_transformer': 0.022980392156862792, 'f_measure_beat_transformer': 0.9885057471264368, 'offset_down_transformer': 0.018083333333333302, 'f_measure_downbeat_transformer': 0.9523809523809523}}

# n_tracks = len(RNN)

# mean_offset_transformer = sum(track_data['offset_transformer'] for track_data in RNN.values()) / n_tracks
# mean_f_measure_beat_transformer = sum(track_data['f_measure_beat_transformer'] for track_data in RNN.values()) / n_tracks
# mean_offset_down_transformer = sum(track_data['offset_down_transformer'] for track_data in RNN.values()) / n_tracks
# mean_f_measure_downbeat_transformer = sum(track_data['f_measure_downbeat_transformer'] for track_data in RNN.values()) / n_tracks

# print('Mean of offset_transformer:', mean_offset_transformer)
# print('Mean of f_measure_beat_transformer:', mean_f_measure_beat_transformer)
# print('Mean of offset_down_transformer:', mean_offset_down_transformer)
# print('Mean of f_measure_downbeat_transformer:', mean_f_measure_downbeat_transformer)
# print("")

# n_tracks = len(TCN)

# mean_offset_transformer = sum(track_data['offset_transformer'] for track_data in TCN.values()) / n_tracks
# mean_f_measure_beat_transformer = sum(track_data['f_measure_beat_transformer'] for track_data in TCN.values()) / n_tracks
# mean_offset_down_transformer = sum(track_data['offset_down_transformer'] for track_data in TCN.values()) / n_tracks
# mean_f_measure_downbeat_transformer = sum(track_data['f_measure_downbeat_transformer'] for track_data in TCN.values()) / n_tracks

# print('Mean of offset_transformer:', mean_offset_transformer)
# print('Mean of f_measure_beat_transformer:', mean_f_measure_beat_transformer)
# print('Mean of offset_down_transformer:', mean_offset_down_transformer)
# print('Mean of f_measure_downbeat_transformer:', mean_f_measure_downbeat_transformer)

import pickle
import numpy as np


def find_nearest_downbeat(segment_start, downbeats):
    idx = np.abs(downbeats - segment_start).argmin()
    return downbeats[idx]

def align_video_segments_with_music(video_data, music_data):
    video_segments = video_data["segments_delimitation"]
    segment_scores = video_data["segments_score"]
    segment_lengths = video_data["segment_length"]

    sorted_segment_indices = np.argsort(segment_scores)[::-1]

    downbeats = music_data["Downbeat"]
    chorus = music_data["Chorus"]

    aligned_segments = []

    for idx in sorted_segment_indices:
        segment_start, segment_end = video_segments[idx]
        segment_length = segment_lengths[idx]

        nearest_downbeat = find_nearest_downbeat(segment_start, downbeats)

        adjusted_start = max(nearest_downbeat, 0)
        adjusted_end = adjusted_start + segment_length

        aligned_segments.append((adjusted_start, adjusted_end))

    # Vous pouvez ajouter du code ici pour vérifier et résoudre les chevauchements de segments vidéo.
    # ...

    return aligned_segments

def resolve_overlapping_segments(aligned_segments, downbeats):
    non_overlapping_segments = []
    aligned_segments.sort(key=lambda x: x[0])

    for segment in aligned_segments:
        if not non_overlapping_segments:
            non_overlapping_segments.append(segment)
        else:
            last_segment_start, last_segment_end = non_overlapping_segments[-1]
            current_segment_start, current_segment_end = segment

            if current_segment_start < last_segment_end:
                extended_segment_end = find_nearest_downbeat(last_segment_end, downbeats)

                if extended_segment_end < current_segment_start:
                    non_overlapping_segments[-1] = (last_segment_start, extended_segment_end)
                    non_overlapping_segments.append(segment)
                else:
                    non_overlapping_segments[-1] = (last_segment_start, current_segment_end)
            else:
                non_overlapping_segments.append(segment)

    return non_overlapping_segments

def align_video_segments_with_music_and_resolve_overlaps(video_data, music_data):
    aligned_segments = align_video_segments_with_music(video_data, music_data)
    non_overlapping_segments = resolve_overlapping_segments(aligned_segments, music_data["Downbeat"])

    return non_overlapping_segments





# Exemple d'utilisation
video_data = {...} # Données de la vidéo
with open('metadata_shivers_30s.pickle', 'rb') as file:
    music_data = pickle.load(file)

# music_data = {...} # Données de la musique

# aligned_segments = align_video_segments_with_music(video_data, music_data)


non_overlapping_segments = align_video_segments_with_music_and_resolve_overlaps(video_data, music_data)

print(aligned_segments)

